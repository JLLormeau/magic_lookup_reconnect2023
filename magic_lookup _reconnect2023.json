{"version":"5","defaultTimeframe":{"from":"now-2h","to":"now"},"sections":[{"id":"be2f2735-8e30-4924-9f56-f68223122a9e","type":"markdown","markdown":"![Delay_payment](https://github.com/JLLormeau/reconnect2023/blob/main/delay_payment.png?raw=true)"},{"id":"3a07c5ac-9e9f-44d5-85a4-18803677158f","type":"markdown","markdown":"## File 1: Gain shared with winners\n> fileds `start_time`, `betID`"},{"id":"29bdd622-514f-47ec-adcc-4c1d5236289d","type":"dql","showTitle":false,"state":{"input":{"value":"data \n    record(timestamp=now()-45m, log.source=\"file1\", content=\"betID=BET_20231019160000, start_time=20231019160000986, winners=65\"),\n    record(timestamp=now()-30m, log.source=\"file1\", content=\"betID=BET_20231019161501, start_time=20231019161501986, winners=47\"),\n    record(timestamp=now()-15m, log.source=\"file1\", content=\"betID=BET_20231019163101, start_time=20231019163101986, winners=118\")\n| parse content,\"'betID=' WORD:betID ', start_time='TIMESTAMP('yyyyMMddHHmmssSSS'):start_time ', winners='INT:nbr_winners\"\n| fields start_time, betID, nbr_winners","timeframe":{"from":"now-2h","to":"now"}},"state":"success","davis":{"includeLogs":true,"isDavisVisualizationAvailable":true},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[["content"]],"firstVisibleRowIndex":0,"columnWidths":{},"enableLineWrap":true}},"result":{"value":{"records":[{"start_time":"2023-10-19T16:00:00.986000000+02:00","betID":"BET_20231019160000","nbr_winners":"65"},{"start_time":"2023-10-19T16:15:01.986000000+02:00","betID":"BET_20231019161501","nbr_winners":"47"},{"start_time":"2023-10-19T16:31:01.986000000+02:00","betID":"BET_20231019163101","nbr_winners":"118"}],"metadata":{"grail":{"canonicalQuery":"data record({timestamp = now() - 45m}, {log.source = \"file1\"}, {content = \"betID=BET_20231019160000, start_time=20231019160000986, winners=65\"}), record({timestamp = now() - 30m}, {log.source = \"file1\"}, {content = \"betID=BET_20231019161501, start_time=20231019161501986, winners=47\"}), record({timestamp = now() - 15m}, {log.source = \"file1\"}, {content = \"betID=BET_20231019163101, start_time=20231019163101986, winners=118\"})\n| parse content, \"'betID=' WORD:betID ', start_time='TIMESTAMP('yyyyMMddHHmmssSSS'):start_time ', winners='INT:nbr_winners\"\n| fields start_time, betID, nbr_winners","timezone":"Europe/Paris","query":"data \n    record(timestamp=now()-45m, log.source=\"file1\", content=\"betID=BET_20231019160000, start_time=20231019160000986, winners=65\"),\n    record(timestamp=now()-30m, log.source=\"file1\", content=\"betID=BET_20231019161501, start_time=20231019161501986, winners=47\"),\n    record(timestamp=now()-15m, log.source=\"file1\", content=\"betID=BET_20231019163101, start_time=20231019163101986, winners=118\")\n| parse content,\"'betID=' WORD:betID ', start_time='TIMESTAMP('yyyyMMddHHmmssSSS'):start_time ', winners='INT:nbr_winners\"\n| fields start_time, betID, nbr_winners","scannedRecords":0,"dqlVersion":"V1_0","scannedBytes":0,"locale":"","executionTimeMilliseconds":5,"notifications":[],"queryId":"85b3e68e-eb69-479e-90f3-0cd9c22858ea","sampled":false}},"types":[{"mappings":{"start_time":{"type":"timestamp"},"betID":{"type":"string"},"nbr_winners":{"type":"long"}},"indexRange":[0,2]}]},"code":200,"notifications":[],"dateTime":"2023-10-07T12:18:41.328Z","input":{"value":"data \n    record(timestamp=now()-45m, log.source=\"file1\", content=\"betID=BET_20231019160000, start_time=20231019160000986, winners=65\"),\n    record(timestamp=now()-30m, log.source=\"file1\", content=\"betID=BET_20231019161501, start_time=20231019161501986, winners=47\"),\n    record(timestamp=now()-15m, log.source=\"file1\", content=\"betID=BET_20231019163101, start_time=20231019163101986, winners=118\")\n| parse content,\"'betID=' WORD:betID ', start_time='TIMESTAMP('yyyyMMddHHmmssSSS'):start_time ', winners='INT:nbr_winners\"\n| fields start_time, betID, nbr_winners","timeframe":{"from":"now-2h","to":"now"}}},"visualization":"table"},"height":159},{"id":"1eaaaa5c-b74d-4c5a-90c1-0d42d8a3ce55","type":"markdown","markdown":"# FILE2: Processing step\n> fields `betID`, `runID`"},{"id":"7008c228-9982-4459-811c-ed73358bcd11","type":"dql","showTitle":false,"state":{"input":{"value":"data \n    record(timestamp=now()-43m, log.source=\"file2\", content=\"betID=BET_20231019160000, runID=2023101900045\"),\n    record(timestamp=now()-28m, log.source=\"file2\", content=\"betID=BET_20231019161501, runID=2023101900055\"),\n    record(timestamp=now()-12m, log.source=\"file2\", content=\"betID=BET_20231019163101, runID=2023101900065\")\n| parse content,\"'betID=' WORD:betID ', runID=' WORD:runID\"\n| fields betID, runID","timeframe":{"from":"now-2h","to":"now"}},"state":"success","davis":{"includeLogs":true,"isDavisVisualizationAvailable":true},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{},"enableLineWrap":true}},"result":{"value":{"records":[{"betID":"BET_20231019160000","runID":"2023101900045"},{"betID":"BET_20231019161501","runID":"2023101900055"},{"betID":"BET_20231019163101","runID":"2023101900065"}],"metadata":{"grail":{"canonicalQuery":"data record({timestamp = now() - 43m}, {log.source = \"file2\"}, {content = \"betID=BET_20231019160000, runID=2023101900045\"}), record({timestamp = now() - 28m}, {log.source = \"file2\"}, {content = \"betID=BET_20231019161501, runID=2023101900055\"}), record({timestamp = now() - 12m}, {log.source = \"file2\"}, {content = \"betID=BET_20231019163101, runID=2023101900065\"})\n| parse content, \"'betID=' WORD:betID ', runID=' WORD:runID\"\n| fields betID, runID","timezone":"Europe/Paris","query":"data \n    record(timestamp=now()-43m, log.source=\"file2\", content=\"betID=BET_20231019160000, runID=2023101900045\"),\n    record(timestamp=now()-28m, log.source=\"file2\", content=\"betID=BET_20231019161501, runID=2023101900055\"),\n    record(timestamp=now()-12m, log.source=\"file2\", content=\"betID=BET_20231019163101, runID=2023101900065\")\n| parse content,\"'betID=' WORD:betID ', runID=' WORD:runID\"\n| fields betID, runID","scannedRecords":0,"dqlVersion":"V1_0","scannedBytes":0,"locale":"","executionTimeMilliseconds":5,"notifications":[],"queryId":"1a081b07-6a94-4be4-93e2-3adbaf6c3e39","sampled":false}},"types":[{"mappings":{"betID":{"type":"string"},"runID":{"type":"string"}},"indexRange":[0,2]}]},"code":200,"notifications":[],"dateTime":"2023-10-07T12:18:41.334Z","input":{"value":"data \n    record(timestamp=now()-43m, log.source=\"file2\", content=\"betID=BET_20231019160000, runID=2023101900045\"),\n    record(timestamp=now()-28m, log.source=\"file2\", content=\"betID=BET_20231019161501, runID=2023101900055\"),\n    record(timestamp=now()-12m, log.source=\"file2\", content=\"betID=BET_20231019163101, runID=2023101900065\")\n| parse content,\"'betID=' WORD:betID ', runID=' WORD:runID\"\n| fields betID, runID","timeframe":{"from":"now-2h","to":"now"}}},"visualization":"table"},"height":159},{"id":"be1307ca-6362-417e-b15c-cefecbc27772","type":"markdown","markdown":"## FILE3: Online payment\n> fields `runID`, `end_time`"},{"id":"aa295fa1-4f71-4fc1-9712-458025a22b56","type":"dql","showTitle":false,"state":{"input":{"value":"data \n    record(timestamp=now()-41m, log.source=\"file3\", content=\"runID=2023101900045, end_time=2023/10/19 16:01:30\"),\n    record(timestamp=now()-26m, log.source=\"file3\", content=\"runID=2023101900055, end_time=2023/10/19 16:18:00\"),\n    record(timestamp=now()-10m, log.source=\"file3\", content=\"runID=2023101900065, end_time=2023/10/19 16:38:30\")\n| parse content,\"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n| fields runID, end_time","timeframe":{"from":"now-2h","to":"now"}},"state":"success","davis":{"includeLogs":true,"isDavisVisualizationAvailable":true},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}},"result":{"code":200,"value":{"records":[{"runID":"2023101900045","end_time":"2023-10-19T16:01:30.000000000+02:00"},{"runID":"2023101900055","end_time":"2023-10-19T16:18:00.000000000+02:00"},{"runID":"2023101900065","end_time":"2023-10-19T16:38:30.000000000+02:00"}],"metadata":{"grail":{"canonicalQuery":"data record({timestamp = now() - 41m}, {log.source = \"file3\"}, {content = \"runID=2023101900045, end_time=2023/10/19 16:01:30\"}), record({timestamp = now() - 26m}, {log.source = \"file3\"}, {content = \"runID=2023101900055, end_time=2023/10/19 16:18:00\"}), record({timestamp = now() - 10m}, {log.source = \"file3\"}, {content = \"runID=2023101900065, end_time=2023/10/19 16:38:30\"})\n| parse content, \"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n| fields runID, end_time","timezone":"Europe/Paris","query":"data \n    record(timestamp=now()-41m, log.source=\"file3\", content=\"runID=2023101900045, end_time=2023/10/19 16:01:30\"),\n    record(timestamp=now()-26m, log.source=\"file3\", content=\"runID=2023101900055, end_time=2023/10/19 16:18:00\"),\n    record(timestamp=now()-10m, log.source=\"file3\", content=\"runID=2023101900065, end_time=2023/10/19 16:38:30\")\n| parse content,\"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n| fields runID, end_time","scannedRecords":0,"dqlVersion":"V1_0","scannedBytes":0,"locale":"","executionTimeMilliseconds":7,"notifications":[],"queryId":"3bfef366-c332-48a1-aaa8-9509e4b92de6","sampled":false}},"types":[{"mappings":{"runID":{"type":"string"},"end_time":{"type":"timestamp"}},"indexRange":[0,2]}]},"notifications":[],"dateTime":"2023-10-07T12:18:41.339Z","input":{"value":"data \n    record(timestamp=now()-41m, log.source=\"file3\", content=\"runID=2023101900045, end_time=2023/10/19 16:01:30\"),\n    record(timestamp=now()-26m, log.source=\"file3\", content=\"runID=2023101900055, end_time=2023/10/19 16:18:00\"),\n    record(timestamp=now()-10m, log.source=\"file3\", content=\"runID=2023101900065, end_time=2023/10/19 16:38:30\")\n| parse content,\"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n| fields runID, end_time","timeframe":{"from":"now-2h","to":"now"}}},"visualization":"table"},"height":174},{"id":"c6d8b2ab-a4e8-4e9e-8aec-529084d12212","type":"markdown","markdown":"## LOOKUP2 on runID : file2 + file3\n> fields `betID`, `runID`, `end_time`"},{"id":"490710bd-ad30-45cf-9bb9-b7941bbc92ed","type":"dql","showTitle":false,"state":{"input":{"value":"//file2\ndata \n    record(timestamp=now()-43m, log.source=\"file2\", content=\"betID=BET_20231019160000, runID=2023101900045\"),\n    record(timestamp=now()-28m, log.source=\"file2\", content=\"betID=BET_20231019161501, runID=2023101900055\"),\n    record(timestamp=now()-12m, log.source=\"file2\", content=\"betID=BET_20231019163101, runID=2023101900065\")\n| parse content,\"'betID=' WORD:betID ', runID=' WORD:runID\"\n| fields timestamp, betID, runID\n| lookup[\n        //file3\n        data \n            record(timestamp=now()-41m, log.source=\"file3\", content=\"runID=2023101900045, end_time=2023/10/19 16:01:30\"),\n            record(timestamp=now()-26m, log.source=\"file3\", content=\"runID=2023101900055, end_time=2023/10/19 16:18:00\"),\n            record(timestamp=now()-10m, log.source=\"file3\", content=\"runID=2023101900065, end_time=2023/10/19 16:38:30\")\n        | parse content,\"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n        ], sourceField: runID, lookupField: runID, fields:{end_time}\n| fields betID,runID, end_time","timeframe":{"from":"now-2h","to":"now"}},"state":"success","davis":{"includeLogs":true,"isDavisVisualizationAvailable":true},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}}},"result":{"code":200,"value":{"records":[{"betID":"BET_20231019160000","runID":"2023101900045","end_time":"2023-10-19T16:01:30.000000000+02:00"},{"betID":"BET_20231019161501","runID":"2023101900055","end_time":"2023-10-19T16:18:00.000000000+02:00"},{"betID":"BET_20231019163101","runID":"2023101900065","end_time":"2023-10-19T16:38:30.000000000+02:00"}],"metadata":{"grail":{"canonicalQuery":"data record({timestamp = now() - 43m}, {log.source = \"file2\"}, {content = \"betID=BET_20231019160000, runID=2023101900045\"}), record({timestamp = now() - 28m}, {log.source = \"file2\"}, {content = \"betID=BET_20231019161501, runID=2023101900055\"}), record({timestamp = now() - 12m}, {log.source = \"file2\"}, {content = \"betID=BET_20231019163101, runID=2023101900065\"})\n| parse content, \"'betID=' WORD:betID ', runID=' WORD:runID\"\n| fields timestamp, betID, runID\n| lookup \n\t[\n\t\tdata record({timestamp = now() - 41m}, {log.source = \"file3\"}, {content = \"runID=2023101900045, end_time=2023/10/19 16:01:30\"}), record({timestamp = now() - 26m}, {log.source = \"file3\"}, {content = \"runID=2023101900055, end_time=2023/10/19 16:18:00\"}), record({timestamp = now() - 10m}, {log.source = \"file3\"}, {content = \"runID=2023101900065, end_time=2023/10/19 16:38:30\"})\n\t\t| parse content, \"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n\t], sourceField:runID, lookupField:runID, fields:{end_time}\n| fields betID, runID, end_time","timezone":"Europe/Paris","query":"//file2\ndata \n    record(timestamp=now()-43m, log.source=\"file2\", content=\"betID=BET_20231019160000, runID=2023101900045\"),\n    record(timestamp=now()-28m, log.source=\"file2\", content=\"betID=BET_20231019161501, runID=2023101900055\"),\n    record(timestamp=now()-12m, log.source=\"file2\", content=\"betID=BET_20231019163101, runID=2023101900065\")\n| parse content,\"'betID=' WORD:betID ', runID=' WORD:runID\"\n| fields timestamp, betID, runID\n| lookup[\n        //file3\n        data \n            record(timestamp=now()-41m, log.source=\"file3\", content=\"runID=2023101900045, end_time=2023/10/19 16:01:30\"),\n            record(timestamp=now()-26m, log.source=\"file3\", content=\"runID=2023101900055, end_time=2023/10/19 16:18:00\"),\n            record(timestamp=now()-10m, log.source=\"file3\", content=\"runID=2023101900065, end_time=2023/10/19 16:38:30\")\n        | parse content,\"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n        ], sourceField: runID, lookupField: runID, fields:{end_time}\n| fields betID,runID, end_time","scannedRecords":0,"dqlVersion":"V1_0","scannedBytes":0,"locale":"","executionTimeMilliseconds":11,"notifications":[],"queryId":"5d0ead91-0d07-48a7-8059-49235810b481","sampled":false}},"types":[{"mappings":{"betID":{"type":"string"},"runID":{"type":"string"},"end_time":{"type":"timestamp"}},"indexRange":[0,2]}]},"notifications":[],"dateTime":"2023-10-07T12:18:41.345Z","input":{"value":"//file2\ndata \n    record(timestamp=now()-43m, log.source=\"file2\", content=\"betID=BET_20231019160000, runID=2023101900045\"),\n    record(timestamp=now()-28m, log.source=\"file2\", content=\"betID=BET_20231019161501, runID=2023101900055\"),\n    record(timestamp=now()-12m, log.source=\"file2\", content=\"betID=BET_20231019163101, runID=2023101900065\")\n| parse content,\"'betID=' WORD:betID ', runID=' WORD:runID\"\n| fields timestamp, betID, runID\n| lookup[\n        //file3\n        data \n            record(timestamp=now()-41m, log.source=\"file3\", content=\"runID=2023101900045, end_time=2023/10/19 16:01:30\"),\n            record(timestamp=now()-26m, log.source=\"file3\", content=\"runID=2023101900055, end_time=2023/10/19 16:18:00\"),\n            record(timestamp=now()-10m, log.source=\"file3\", content=\"runID=2023101900065, end_time=2023/10/19 16:38:30\")\n        | parse content,\"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n        ], sourceField: runID, lookupField: runID, fields:{end_time}\n| fields betID,runID, end_time","timeframe":{"from":"now-2h","to":"now"}}},"visualization":"table"},"height":181},{"id":"f06b80cc-4d8a-4669-a004-2b1290ea1519","type":"markdown","markdown":"## LOOKUP1 on betID : file1 + lookup2 (file2 + file3)\n> fields `start_time`, `betID`, `runID`, `delay_payment` = ( `end_time` - `start_time`)"},{"id":"1483c80c-4906-4cf6-bd30-38dd1d1a8dd9","type":"dql","showTitle":false,"state":{"input":{"value":"//file1\ndata \n    record(timestamp=now()-45m, log.source=\"file1\", content=\"betID=BET_20231019160000, start_time=20231019160000986, winners=65\"),\n    record(timestamp=now()-30m, log.source=\"file1\", content=\"betID=BET_20231019161501, start_time=20231019161501986, winners=47\"),\n    record(timestamp=now()-15m, log.source=\"file1\", content=\"betID=BET_20231019163101, start_time=20231019163101986, winners=118\")\n| parse content,\"'betID=' WORD:betID ', start_time='TIMESTAMP('yyyyMMddHHmmssSSS'):start_time ', winners='INT:nbr_winners\"\n| lookup[\n        //lookup2\n        //file2\n        data \n            record(timestamp=now()-43m, log.source=\"file2\", content=\"betID=BET_20231019160000, runID=2023101900045\"),\n            record(timestamp=now()-28m, log.source=\"file2\", content=\"betID=BET_20231019161501, runID=2023101900055\"),\n            record(timestamp=now()-12m, log.source=\"file2\", content=\"betID=BET_20231019163101, runID=2023101900065\")\n        | parse content,\"'betID=' WORD:betID ', runID=' WORD:runID\"\n        | fields timestamp, betID, runID\n        | lookup[\n                //file3\n                data \n                    record(timestamp=now()-41m, log.source=\"file3\", content=\"runID=2023101900045, end_time=2023/10/19 16:01:30\"),\n                    record(timestamp=now()-26m, log.source=\"file3\", content=\"runID=2023101900055, end_time=2023/10/19 16:18:00\"),\n                    record(timestamp=now()-10m, log.source=\"file3\", content=\"runID=2023101900065, end_time=2023/10/19 16:38:30\")\n                | parse content,\"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n                ], sourceField: runID, lookupField: runID, fields:{end_time}\n        //end of looku2\n        ], sourceField:betID, lookupField:betID, fields:{runID, end_time}\n| fields start_time, betID, runID, delay_payment=(end_time - start_time)","timeframe":{"from":"now-2h","to":"now"}},"state":"success","davis":{"includeLogs":true,"isDavisVisualizationAvailable":true},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[["content"]],"firstVisibleRowIndex":0,"columnWidths":{}}},"result":{"code":200,"value":{"records":[{"start_time":"2023-10-19T16:00:00.986000000+02:00","betID":"BET_20231019160000","runID":"2023101900045","delay_payment":"89014000000"},{"start_time":"2023-10-19T16:15:01.986000000+02:00","betID":"BET_20231019161501","runID":"2023101900055","delay_payment":"178014000000"},{"start_time":"2023-10-19T16:31:01.986000000+02:00","betID":"BET_20231019163101","runID":"2023101900065","delay_payment":"448014000000"}],"metadata":{"grail":{"canonicalQuery":"data record({timestamp = now() - 45m}, {log.source = \"file1\"}, {content = \"betID=BET_20231019160000, start_time=20231019160000986, winners=65\"}), record({timestamp = now() - 30m}, {log.source = \"file1\"}, {content = \"betID=BET_20231019161501, start_time=20231019161501986, winners=47\"}), record({timestamp = now() - 15m}, {log.source = \"file1\"}, {content = \"betID=BET_20231019163101, start_time=20231019163101986, winners=118\"})\n| parse content, \"'betID=' WORD:betID ', start_time='TIMESTAMP('yyyyMMddHHmmssSSS'):start_time ', winners='INT:nbr_winners\"\n| lookup \n\t[\n\t\tdata record({timestamp = now() - 43m}, {log.source = \"file2\"}, {content = \"betID=BET_20231019160000, runID=2023101900045\"}), record({timestamp = now() - 28m}, {log.source = \"file2\"}, {content = \"betID=BET_20231019161501, runID=2023101900055\"}), record({timestamp = now() - 12m}, {log.source = \"file2\"}, {content = \"betID=BET_20231019163101, runID=2023101900065\"})\n\t\t| parse content, \"'betID=' WORD:betID ', runID=' WORD:runID\"\n\t\t| fields timestamp, betID, runID\n\t\t| lookup \n\t\t\t[\n\t\t\t\tdata record({timestamp = now() - 41m}, {log.source = \"file3\"}, {content = \"runID=2023101900045, end_time=2023/10/19 16:01:30\"}), record({timestamp = now() - 26m}, {log.source = \"file3\"}, {content = \"runID=2023101900055, end_time=2023/10/19 16:18:00\"}), record({timestamp = now() - 10m}, {log.source = \"file3\"}, {content = \"runID=2023101900065, end_time=2023/10/19 16:38:30\"})\n\t\t\t\t| parse content, \"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n\t\t\t], sourceField:runID, lookupField:runID, fields:{end_time}\n\t], sourceField:betID, lookupField:betID, fields:{runID, end_time}\n| fields start_time, betID, runID, {end_time - start_time, alias:delay_payment}","timezone":"Europe/Paris","query":"//file1\ndata \n    record(timestamp=now()-45m, log.source=\"file1\", content=\"betID=BET_20231019160000, start_time=20231019160000986, winners=65\"),\n    record(timestamp=now()-30m, log.source=\"file1\", content=\"betID=BET_20231019161501, start_time=20231019161501986, winners=47\"),\n    record(timestamp=now()-15m, log.source=\"file1\", content=\"betID=BET_20231019163101, start_time=20231019163101986, winners=118\")\n| parse content,\"'betID=' WORD:betID ', start_time='TIMESTAMP('yyyyMMddHHmmssSSS'):start_time ', winners='INT:nbr_winners\"\n| lookup[\n        //lookup2\n        //file2\n        data \n            record(timestamp=now()-43m, log.source=\"file2\", content=\"betID=BET_20231019160000, runID=2023101900045\"),\n            record(timestamp=now()-28m, log.source=\"file2\", content=\"betID=BET_20231019161501, runID=2023101900055\"),\n            record(timestamp=now()-12m, log.source=\"file2\", content=\"betID=BET_20231019163101, runID=2023101900065\")\n        | parse content,\"'betID=' WORD:betID ', runID=' WORD:runID\"\n        | fields timestamp, betID, runID\n        | lookup[\n                //file3\n                data \n                    record(timestamp=now()-41m, log.source=\"file3\", content=\"runID=2023101900045, end_time=2023/10/19 16:01:30\"),\n                    record(timestamp=now()-26m, log.source=\"file3\", content=\"runID=2023101900055, end_time=2023/10/19 16:18:00\"),\n                    record(timestamp=now()-10m, log.source=\"file3\", content=\"runID=2023101900065, end_time=2023/10/19 16:38:30\")\n                | parse content,\"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n                ], sourceField: runID, lookupField: runID, fields:{end_time}\n        //end of looku2\n        ], sourceField:betID, lookupField:betID, fields:{runID, end_time}\n| fields start_time, betID, runID, delay_payment=(end_time - start_time)","scannedRecords":0,"dqlVersion":"V1_0","scannedBytes":0,"locale":"","executionTimeMilliseconds":17,"notifications":[],"queryId":"107d6e2e-ce1b-44e4-9d44-406ed8a21947","sampled":false}},"types":[{"mappings":{"start_time":{"type":"timestamp"},"betID":{"type":"string"},"runID":{"type":"string"},"delay_payment":{"type":"duration"}},"indexRange":[0,2]}]},"notifications":[],"dateTime":"2023-10-07T12:18:41.350Z","input":{"value":"//file1\ndata \n    record(timestamp=now()-45m, log.source=\"file1\", content=\"betID=BET_20231019160000, start_time=20231019160000986, winners=65\"),\n    record(timestamp=now()-30m, log.source=\"file1\", content=\"betID=BET_20231019161501, start_time=20231019161501986, winners=47\"),\n    record(timestamp=now()-15m, log.source=\"file1\", content=\"betID=BET_20231019163101, start_time=20231019163101986, winners=118\")\n| parse content,\"'betID=' WORD:betID ', start_time='TIMESTAMP('yyyyMMddHHmmssSSS'):start_time ', winners='INT:nbr_winners\"\n| lookup[\n        //lookup2\n        //file2\n        data \n            record(timestamp=now()-43m, log.source=\"file2\", content=\"betID=BET_20231019160000, runID=2023101900045\"),\n            record(timestamp=now()-28m, log.source=\"file2\", content=\"betID=BET_20231019161501, runID=2023101900055\"),\n            record(timestamp=now()-12m, log.source=\"file2\", content=\"betID=BET_20231019163101, runID=2023101900065\")\n        | parse content,\"'betID=' WORD:betID ', runID=' WORD:runID\"\n        | fields timestamp, betID, runID\n        | lookup[\n                //file3\n                data \n                    record(timestamp=now()-41m, log.source=\"file3\", content=\"runID=2023101900045, end_time=2023/10/19 16:01:30\"),\n                    record(timestamp=now()-26m, log.source=\"file3\", content=\"runID=2023101900055, end_time=2023/10/19 16:18:00\"),\n                    record(timestamp=now()-10m, log.source=\"file3\", content=\"runID=2023101900065, end_time=2023/10/19 16:38:30\")\n                | parse content,\"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n                ], sourceField: runID, lookupField: runID, fields:{end_time}\n        //end of looku2\n        ], sourceField:betID, lookupField:betID, fields:{runID, end_time}\n| fields start_time, betID, runID, delay_payment=(end_time - start_time)","timeframe":{"from":"now-2h","to":"now"}}},"visualization":"table"},"height":160},{"id":"1b4aea1b-13f1-43f2-be82-f2cc1d9bf196","type":"markdown","markdown":"## SLO\n> fields `SLO`, `target`, `SLO_success` (true if `SLO` > `target`, false if not), `nbr_failed`\n\nAdd this content\n``````\n| summarize nbr_failed=countIf(delay_payment > 6m), total=count()\n| fieldsAdd SLO=(toDouble(total - nbr_failed) * 100 / total) \n| fieldsAdd target=99\n| fields SLO, target, SLO_success = if((SLO < target),false, else: true), nbr_failed\n``````"},{"id":"805e6b79-a3ba-4c6d-b215-e16967b298a9","type":"dql","showTitle":false,"state":{"input":{"value":"//file1\ndata \n    record(timestamp=now()-45m, log.source=\"file1\", content=\"betID=BET_20231019160000, start_time=20231019160000986, winners=65\"),\n    record(timestamp=now()-30m, log.source=\"file1\", content=\"betID=BET_20231019161501, start_time=20231019161501986, winners=47\"),\n    record(timestamp=now()-15m, log.source=\"file1\", content=\"betID=BET_20231019163101, start_time=20231019163101986, winners=118\")\n| parse content,\"'betID=' WORD:betID ', start_time='TIMESTAMP('yyyyMMddHHmmssSSS'):start_time ', winners='INT:nbr_winners\"\n| lookup[\n        //lookup2\n        //file2\n        data \n            record(timestamp=now()-43m, log.source=\"file2\", content=\"betID=BET_20231019160000, runID=2023101900045\"),\n            record(timestamp=now()-28m, log.source=\"file2\", content=\"betID=BET_20231019161501, runID=2023101900055\"),\n            record(timestamp=now()-12m, log.source=\"file2\", content=\"betID=BET_20231019163101, runID=2023101900065\")\n        | parse content,\"'betID=' WORD:betID ', runID=' WORD:runID\"\n        | fields timestamp, betID, runID\n        | lookup[\n                //file3\n                data \n                    record(timestamp=now()-41m, log.source=\"file3\", content=\"runID=2023101900045, end_time=2023/10/19 16:01:30\"),\n                    record(timestamp=now()-26m, log.source=\"file3\", content=\"runID=2023101900055, end_time=2023/10/19 16:18:00\"),\n                    record(timestamp=now()-10m, log.source=\"file3\", content=\"runID=2023101900065, end_time=2023/10/19 16:38:30\")\n                | parse content,\"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n                ], sourceField: runID, lookupField: runID, fields:{end_time}\n        //end of lookup2\n        ], sourceField:betID, lookupField:betID, fields:{runID, end_time}\n| fields start_time, betID, runID, delay_payment=(end_time - start_time)\n//SLO Calulation\n| summarize nbr_failed=countIf(delay_payment > 6m), total=count()\n| fieldsAdd SLO=(toDouble(total - nbr_failed) * 100 / total) \n| fieldsAdd target=99\n| fields SLO, target, SLO_success = if((SLO < target),false, else: true), nbr_failed","timeframe":{"from":"now-2h","to":"now"}},"state":"success","davis":{"includeLogs":true,"isDavisVisualizationAvailable":true},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[["content"]],"firstVisibleRowIndex":0,"columnWidths":{}}},"result":{"code":200,"value":{"records":[{"SLO":66.66666666666667,"target":"99","SLO_success":false,"nbr_failed":"1"}],"metadata":{"grail":{"canonicalQuery":"data record({timestamp = now() - 45m}, {log.source = \"file1\"}, {content = \"betID=BET_20231019160000, start_time=20231019160000986, winners=65\"}), record({timestamp = now() - 30m}, {log.source = \"file1\"}, {content = \"betID=BET_20231019161501, start_time=20231019161501986, winners=47\"}), record({timestamp = now() - 15m}, {log.source = \"file1\"}, {content = \"betID=BET_20231019163101, start_time=20231019163101986, winners=118\"})\n| parse content, \"'betID=' WORD:betID ', start_time='TIMESTAMP('yyyyMMddHHmmssSSS'):start_time ', winners='INT:nbr_winners\"\n| lookup \n\t[\n\t\tdata record({timestamp = now() - 43m}, {log.source = \"file2\"}, {content = \"betID=BET_20231019160000, runID=2023101900045\"}), record({timestamp = now() - 28m}, {log.source = \"file2\"}, {content = \"betID=BET_20231019161501, runID=2023101900055\"}), record({timestamp = now() - 12m}, {log.source = \"file2\"}, {content = \"betID=BET_20231019163101, runID=2023101900065\"})\n\t\t| parse content, \"'betID=' WORD:betID ', runID=' WORD:runID\"\n\t\t| fields timestamp, betID, runID\n\t\t| lookup \n\t\t\t[\n\t\t\t\tdata record({timestamp = now() - 41m}, {log.source = \"file3\"}, {content = \"runID=2023101900045, end_time=2023/10/19 16:01:30\"}), record({timestamp = now() - 26m}, {log.source = \"file3\"}, {content = \"runID=2023101900055, end_time=2023/10/19 16:18:00\"}), record({timestamp = now() - 10m}, {log.source = \"file3\"}, {content = \"runID=2023101900065, end_time=2023/10/19 16:38:30\"})\n\t\t\t\t| parse content, \"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n\t\t\t], sourceField:runID, lookupField:runID, fields:{end_time}\n\t], sourceField:betID, lookupField:betID, fields:{runID, end_time}\n| fields start_time, betID, runID, {end_time - start_time, alias:delay_payment}\n| summarize {countIf(delay_payment > 6m), alias:nbr_failed}, {count(), alias:total}\n| fieldsAdd toDouble(total - nbr_failed) * 100 / total, alias:SLO\n| fieldsAdd 99, alias:target\n| fields SLO, target, {if(SLO < target, FALSE, else:TRUE), alias:SLO_success}, nbr_failed","timezone":"Europe/Paris","query":"//file1\ndata \n    record(timestamp=now()-45m, log.source=\"file1\", content=\"betID=BET_20231019160000, start_time=20231019160000986, winners=65\"),\n    record(timestamp=now()-30m, log.source=\"file1\", content=\"betID=BET_20231019161501, start_time=20231019161501986, winners=47\"),\n    record(timestamp=now()-15m, log.source=\"file1\", content=\"betID=BET_20231019163101, start_time=20231019163101986, winners=118\")\n| parse content,\"'betID=' WORD:betID ', start_time='TIMESTAMP('yyyyMMddHHmmssSSS'):start_time ', winners='INT:nbr_winners\"\n| lookup[\n        //lookup2\n        //file2\n        data \n            record(timestamp=now()-43m, log.source=\"file2\", content=\"betID=BET_20231019160000, runID=2023101900045\"),\n            record(timestamp=now()-28m, log.source=\"file2\", content=\"betID=BET_20231019161501, runID=2023101900055\"),\n            record(timestamp=now()-12m, log.source=\"file2\", content=\"betID=BET_20231019163101, runID=2023101900065\")\n        | parse content,\"'betID=' WORD:betID ', runID=' WORD:runID\"\n        | fields timestamp, betID, runID\n        | lookup[\n                //file3\n                data \n                    record(timestamp=now()-41m, log.source=\"file3\", content=\"runID=2023101900045, end_time=2023/10/19 16:01:30\"),\n                    record(timestamp=now()-26m, log.source=\"file3\", content=\"runID=2023101900055, end_time=2023/10/19 16:18:00\"),\n                    record(timestamp=now()-10m, log.source=\"file3\", content=\"runID=2023101900065, end_time=2023/10/19 16:38:30\")\n                | parse content,\"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n                ], sourceField: runID, lookupField: runID, fields:{end_time}\n        //end of lookup2\n        ], sourceField:betID, lookupField:betID, fields:{runID, end_time}\n| fields start_time, betID, runID, delay_payment=(end_time - start_time)\n//SLO Calulation\n| summarize nbr_failed=countIf(delay_payment > 6m), total=count()\n| fieldsAdd SLO=(toDouble(total - nbr_failed) * 100 / total) \n| fieldsAdd target=99\n| fields SLO, target, SLO_success = if((SLO < target),false, else: true), nbr_failed","scannedRecords":0,"dqlVersion":"V1_0","scannedBytes":0,"locale":"","executionTimeMilliseconds":35,"notifications":[],"queryId":"f2b79b4b-1538-4f14-a793-545110fbb3d5","sampled":false}},"types":[{"mappings":{"SLO":{"type":"double"},"target":{"type":"long"},"SLO_success":{"type":"boolean"},"nbr_failed":{"type":"long"}},"indexRange":[0,0]}]},"notifications":[],"dateTime":"2023-10-07T12:18:41.356Z","input":{"value":"//file1\ndata \n    record(timestamp=now()-45m, log.source=\"file1\", content=\"betID=BET_20231019160000, start_time=20231019160000986, winners=65\"),\n    record(timestamp=now()-30m, log.source=\"file1\", content=\"betID=BET_20231019161501, start_time=20231019161501986, winners=47\"),\n    record(timestamp=now()-15m, log.source=\"file1\", content=\"betID=BET_20231019163101, start_time=20231019163101986, winners=118\")\n| parse content,\"'betID=' WORD:betID ', start_time='TIMESTAMP('yyyyMMddHHmmssSSS'):start_time ', winners='INT:nbr_winners\"\n| lookup[\n        //lookup2\n        //file2\n        data \n            record(timestamp=now()-43m, log.source=\"file2\", content=\"betID=BET_20231019160000, runID=2023101900045\"),\n            record(timestamp=now()-28m, log.source=\"file2\", content=\"betID=BET_20231019161501, runID=2023101900055\"),\n            record(timestamp=now()-12m, log.source=\"file2\", content=\"betID=BET_20231019163101, runID=2023101900065\")\n        | parse content,\"'betID=' WORD:betID ', runID=' WORD:runID\"\n        | fields timestamp, betID, runID\n        | lookup[\n                //file3\n                data \n                    record(timestamp=now()-41m, log.source=\"file3\", content=\"runID=2023101900045, end_time=2023/10/19 16:01:30\"),\n                    record(timestamp=now()-26m, log.source=\"file3\", content=\"runID=2023101900055, end_time=2023/10/19 16:18:00\"),\n                    record(timestamp=now()-10m, log.source=\"file3\", content=\"runID=2023101900065, end_time=2023/10/19 16:38:30\")\n                | parse content,\"'runID=' WORD:runID ', end_time='TIMESTAMP('yyyy/MM/d HH:mm:ss'):end_time\"\n                ], sourceField: runID, lookupField: runID, fields:{end_time}\n        //end of lookup2\n        ], sourceField:betID, lookupField:betID, fields:{runID, end_time}\n| fields start_time, betID, runID, delay_payment=(end_time - start_time)\n//SLO Calulation\n| summarize nbr_failed=countIf(delay_payment > 6m), total=count()\n| fieldsAdd SLO=(toDouble(total - nbr_failed) * 100 / total) \n| fieldsAdd target=99\n| fields SLO, target, SLO_success = if((SLO < target),false, else: true), nbr_failed","timeframe":{"from":"now-2h","to":"now"}}},"visualization":"table"},"height":70},{"id":"220666d2-5523-4e31-ac2a-db85527b2c3e","type":"markdown","markdown":"# Workflow\nFrom this DQL request, create a workflow\nAdd HTTP Request: \n\n## INPUT  \n   ``````\n   POST\n   ``````\n   \n   ``````\n   https://webhook.site/b5c16a6f-f194-4e10-9e3f-c5939d873b74`\n   ``````\n   \n   ``````\n   {\n   \"name\": \"<yourname>\",\n   \"SLO_success\": \"{{ result(\"execute_dql_query_1\").records[0].SLO_success }}\",  \n   \"SLO\": \"{{ result(\"execute_dql_query_1\").records[0].SLO }}\",  \n   \"target\": \"{{ result(\"execute_dql_query_1\").records[0].target }}\",  \n   \"nbr_failed\": \"{{ result(\"execute_dql_query_1\").records[0].nbr_failed }}\"  \n   }\n   ``````\n\n## CONDITIONS\n  ``````\n  {{ result(\"execute_dql_query_1\").records[0].SLO_success == False }}\n  ``````\n\n"}]}